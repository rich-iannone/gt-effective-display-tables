# The gt datasets {#sec-appendix-datasets}

```{r setup, include=FALSE, echo=FALSE}
library(gt)
library(dplyr)
```

Every dataset tells a story. The eighteen datasets bundled with **gt** were not assembled arbitrarily or pulled from dusty archives of convenient CSV files. Each one emerged from a specific need, a personal curiosity, or a gap in what was publicly available. Some model human behavior with surprising fidelity. Others preserve scientific data that would otherwise remain scattered across obscure government pages. A few exist simply because I thought "I wish this dataset existed" and then made it so.

This appendix takes you behind the scenes of these datasets. You will learn where they came from, how they were constructed, and why they matter beyond their immediate utility as demonstration data. Along the way, we will explore the broader contexts they represent: the economics of a neighborhood pizza shop, the 125-year evolution of urban transit in Paris, the delicate chemistry of Earth's atmosphere, and the quiet dramas of population change in Ontario's small towns. The datasets are more than rows and columns. They are windows into worlds worth understanding.
## gibraltar

The `gibraltar` dataset contains hourly weather observations from Gibraltar during May 2023: temperature, humidity, wind speed, cloud cover, and other meteorological variables. It provides 744 rows representing each hour of a single month in this small but fascinating territory.

```{r}
gibraltar |>
  slice_sample(n = 8) |>
  select(date, time, temp, humidity, wind_speed, wind_dir) |>
  gt() |>
  fmt_number(columns = temp, decimals = 1) |>
  fmt_integer(columns = c(humidity, wind_speed)) |>
  cols_label(
    date = "Date",
    time = "Time", 
    temp = "Temp (°C)",
    humidity = "Humidity %",
    wind_speed = "Wind (km/h)",
    wind_dir = "Direction"
  )
```

Gibraltar sits at the southern tip of the Iberian Peninsula, a British Overseas Territory of barely seven square kilometers guarding the entrance to the Mediterranean Sea. It is the kind of place that captures the imagination precisely because it seems improbable: a limestone promontory with its own airport runway crossing the main road, Barbary macaques roaming the upper rock, and a rather complex history.


## rx_adsl and rx_addv

These two datasets represent **gt**'s connection to the pharmaceutical industry, where clinical trial tables must meet rigorous standards for regulatory submission. The datasets follow CDISC (Clinical Data Interchange Standards Consortium) conventions, specifically the ADaM (Analysis Data Model) structure used throughout the pharmaceutical industry.

`rx_adsl` contains subject-level data (ADSL format) for 182 participants in a fictional clinical trial. `rx_addv` provides protocol deviation records (ADDV format) with 910 entries documenting when and how trial participants deviated from study protocols. Both datasets use standard variable names and coding conventions that pharmaceutical statisticians will immediately recognize.

```{r}
rx_adsl |>
  select(USUBJID, AGE, SEX, COUNTRY, TRTA) |>
  slice_head(n = 8) |>
  gt() |>
  cols_label(
    USUBJID = "Subject ID",
    AGE = "Age",
    SEX = "Sex",
    COUNTRY = "Country",
    TRTA = "Treatment"
  )
```

### The language of clinical trials

Pharmaceutical data follows conventions that seem arcane to outsiders but enable precise communication among specialists. USUBJID uniquely identifies a subject across all studies from a sponsor. TRTA indicates the actual treatment received (as opposed to the treatment assigned). SAFFL flags subjects in the safety population. This vocabulary, defined by CDISC standards, appears in regulatory submissions worldwide. A statistician in Switzerland reviewing a submission from Japan knows exactly what TRTA means because the standards are universal.

```{r}
#| echo: false
rx_adsl |>
  group_by(TRTA) |>
  summarize(
    subjects = n(),
    avg_age = mean(AGE, na.rm = TRUE),
    pct_female = mean(SEX == "F", na.rm = TRUE) * 100,
    countries = n_distinct(COUNTRY),
    .groups = "drop"
  ) |>
  gt(rowname_col = "TRTA") |>
  fmt_number(columns = avg_age, decimals = 1) |>
  fmt_number(columns = pct_female, decimals = 0, pattern = "{x}%") |>
  cols_label(
    subjects = "Subjects",
    avg_age = "Mean Age",
    pct_female = "Female",
    countries = "Countries"
  ) |>
  tab_header(title = "Treatment Arm Demographics")
```

The treatment arms in clinical trials typically include the experimental treatment at one or more doses, a placebo or active comparator, and sometimes multiple dosing regimens. Demographic balance across arms helps ensure that observed differences reflect treatment effects rather than baseline differences. Age, sex, ethnicity, disease severity at baseline, and prior treatments all require documentation and comparison.

```{r}
#| echo: false
rx_addv |>
  count(DVCAT) |>
  arrange(desc(n)) |>
  head(8) |>
  gt(rowname_col = "DVCAT") |>
  cols_label(n = "Deviations") |>
  tab_header(title = "Protocol Deviation Categories")
```

Protocol deviations document when trial participants did not follow the study plan. Some deviations are minor (a visit occurring outside the allowed window). Others are major (taking prohibited medications, missing doses). The `rx_addv` dataset catalogs these deviations, enabling sensitivity analyses that exclude subjects with major violations. Regulators scrutinize deviation patterns for evidence that the trial was conducted properly and that deviations do not undermine the conclusions.

These datasets were contributed by Alexandra Lauer as part of ongoing collaboration between **gt** developers and pharmaceutical industry users. The package website includes a dedicated case study article demonstrating how to create clinical tables that meet industry standards. For pharmaceutical statisticians evaluating **gt** for regulatory work, these datasets provide immediately relevant examples.

The inclusion of pharmaceutical data reflects **gt**'s ambition to serve professional communities with specialized requirements. Clinical trials generate enormous quantities of tabular output, much of it following strict formatting conventions. Having sample datasets in the standard format lowers the barrier for pharmaceutical users to adopt **gt** and verify that it meets their needs.

## The value of curated datasets

Looking across all eighteen datasets, certain patterns emerge. Many fill gaps where public data existed but not in convenient form. The scientific datasets consolidate information scattered across journals and government pages. The `films` dataset creates a resource that simply did not exist before. Even the simulated `pizzaplace` data serves a purpose: realistic transactional data is rarely available publicly due to business confidentiality.

Other datasets reflect personal curiosity. Ontario towns. The Paris Métro. Gibraltar's weather. Cannes films. These choices say something about my interests and the particular corners of the world that captured my attention. The datasets are better for this personal investment. Someone who cares about the Paris Métro will notice details that a disinterested compiler would miss.

